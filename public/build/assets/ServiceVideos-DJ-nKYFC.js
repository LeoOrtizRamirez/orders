import{d as oe,r as $,c as D,w as te,P as de,l as i,q as A,f as M,u as y,m as e,t,a3 as _e,k as d,x as _,A as x,a2 as L,H as ie,y as F,F as Q,D as se,G as me,o as he,I as re,E as ge}from"./vendor-BuRU_kNN.js";import{d as le,c as X,_ as ne,b as fe}from"./main-Dt_U_J2X.js";import{S as Z}from"./sweetalert2.esm.all-5zhdP7Ax.js";import{Y as ue,h as ee,_ as ce,G as ve,S as pe}from"./transition-DmF2Pzyd.js";import"./quill-De1S0mUZ.js";import"./hidden-CJVN9Aon.js";import"./keyboard-CA3kR_KZ.js";import"./open-closed-BTc9WkmO.js";const be={class:"fixed inset-0 overflow-y-auto"},$e={class:"flex min-h-full items-center justify-center px-4 py-8"},ye={class:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]"},we={class:"p-5"},ke={class:"mb-5"},xe={for:"title"},Ce=["placeholder"],Me={key:0,class:"text-danger mt-1"},Ve={class:"mb-5"},Se={for:"slug"},je=["placeholder"],Be={class:"text-xs text-gray-500 mt-1"},Ue={key:0,class:"text-danger mt-1"},Ae={class:"mb-5"},Ie={for:"description"},Le=["placeholder"],De={key:0,class:"text-danger mt-1"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-5"},ze={for:"video_url"},He=["placeholder"],Fe={class:"text-xs text-gray-500 mt-1"},qe={key:0,class:"text-danger mt-1"},Ne={for:"thumbnail_url"},Te=["placeholder"],Pe={key:0,class:"text-danger mt-1"},Re={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-5"},Ge={for:"duration_seconds"},Ye=["placeholder"],We={key:0,class:"text-xs text-gray-500 mt-1"},Je={key:1,class:"text-danger mt-1"},Ke={for:"order"},Oe=["placeholder"],Qe={key:0,class:"text-danger mt-1"},Xe={for:"tags"},Ze=["placeholder"],et={class:"text-xs text-gray-500 mt-1"},tt={key:0,class:"text-danger mt-1"},st={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-5"},ot={class:"flex items-center cursor-pointer"},lt={class:"text-white-dark ltr:ml-3 rtl:mr-3"},at={class:"text-xs text-gray-500 mt-1"},it={class:"flex items-center cursor-pointer"},rt={class:"text-white-dark ltr:ml-3 rtl:mr-3"},dt={class:"text-xs text-gray-500 mt-1"},nt={key:0,class:"mb-5"},ut={class:"block mb-2"},ct=["src"],vt={class:"flex justify-end items-center mt-8"},pt=["disabled"],_t=["disabled"],mt={key:0,class:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 ltr:mr-2 rtl:ml-2 inline-block"},ht=oe({__name:"VideoModal",props:{show:{type:Boolean},video:{},serviceId:{}},emits:["close","saved"],setup(R,{emit:C}){const{t:I}=le(),f=R,q=C,w=$(!1),u=$({}),V=$(""),S={title:"",slug:"",description:"",video_url:"",thumbnail_url:"",duration_seconds:0,order:0,is_free:!1,is_active:!0,tags:[]},n=$({...S}),E=D(()=>n.value.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-").substring(0,50));te(()=>n.value.title,l=>{l&&!n.value.slug&&(n.value.slug=E.value)}),te(V,l=>{l?n.value.tags=l.split(",").map(r=>r.trim()).filter(r=>r):n.value.tags=[]}),te(()=>f.video,l=>{l&&(n.value={...l},V.value=Array.isArray(l.tags)?l.tags.join(", "):"")},{immediate:!0});const U=()=>{n.value={...S},V.value="",u.value={}},a=l=>{const r=Math.floor(l/3600),c=Math.floor(l%3600/60),j=l%60;return r>0?`${r}h ${c}m ${j}s`:c>0?`${c}m ${j}s`:`${j}s`},v=l=>{const r=l.target;r.style.display="none"},h=()=>{w.value||(U(),q("close"))},g=async()=>{var l,r,c,j,N;w.value=!0,u.value={};try{const B={...n.value,service_id:f.serviceId};let z;(l=f.video)!=null&&l.id?z=await X.put(`/api/videos/${f.video.id}`,B):z=await X.post("/api/videos",B),q("saved",z.data),Z.fire({icon:"success",title:I("video_modal.success_title"),text:(r=f.video)!=null&&r.id?I("video_modal.success_edit"):I("video_modal.success_add"),timer:2e3,showConfirmButton:!1})}catch(B){((c=B.response)==null?void 0:c.status)===422?u.value=B.response.data.errors:Z.fire({icon:"error",title:I("video_modal.error_title"),text:((N=(j=B.response)==null?void 0:j.data)==null?void 0:N.message)||I("video_modal.error_message")})}finally{w.value=!1}};return(l,r)=>(i(),de(y(pe),{appear:"",show:l.show,as:"template"},{default:A(()=>[M(y(ue),{as:"div",onClose:h,class:"relative z-[51]"},{default:A(()=>[M(y(ee),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:A(()=>[M(y(ce),{class:"fixed inset-0 bg-[black]/60"})]),_:1}),e("div",be,[e("div",$e,[M(y(ee),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:A(()=>[M(y(ve),{class:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-2xl text-black dark:text-white-dark"},{default:A(()=>[e("button",{type:"button",class:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:h},[...r[10]||(r[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"w-6 h-6"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),e("div",ye,t(l.video?l.$t("video_modal.edit_video"):l.$t("video_modal.add_video")),1),e("div",we,[e("form",{onSubmit:_e(g,["prevent"])},[e("div",ke,[e("label",xe,t(l.$t("video_modal.video_title"))+" *",1),x(e("input",{id:"title",type:"text",placeholder:l.$t("video_modal.title_placeholder"),class:"form-input","onUpdate:modelValue":r[0]||(r[0]=c=>n.value.title=c),required:""},null,8,Ce),[[L,n.value.title]]),u.value.title?(i(),d("div",Me,t(u.value.title[0]),1)):_("",!0)]),e("div",Ve,[e("label",Se,t(l.$t("video_modal.slug"))+" *",1),x(e("input",{id:"slug",type:"text",placeholder:l.$t("video_modal.slug_placeholder"),class:"form-input","onUpdate:modelValue":r[1]||(r[1]=c=>n.value.slug=c),required:""},null,8,je),[[L,n.value.slug]]),e("div",Be,t(l.$t("video_modal.slug_helper")),1),u.value.slug?(i(),d("div",Ue,t(u.value.slug[0]),1)):_("",!0)]),e("div",Ae,[e("label",Ie,t(l.$t("video_modal.description")),1),x(e("textarea",{id:"description",placeholder:l.$t("video_modal.description_placeholder"),class:"form-textarea min-h-[100px]","onUpdate:modelValue":r[2]||(r[2]=c=>n.value.description=c)},null,8,Le),[[L,n.value.description]]),u.value.description?(i(),d("div",De,t(u.value.description[0]),1)):_("",!0)]),e("div",Ee,[e("div",null,[e("label",ze,t(l.$t("video_modal.video_url"))+" *",1),x(e("input",{id:"video_url",type:"url",placeholder:l.$t("video_modal.video_url_placeholder"),class:"form-input","onUpdate:modelValue":r[3]||(r[3]=c=>n.value.video_url=c),required:""},null,8,He),[[L,n.value.video_url]]),e("div",Fe,t(l.$t("video_modal.video_url_helper")),1),u.value.video_url?(i(),d("div",qe,t(u.value.video_url[0]),1)):_("",!0)]),e("div",null,[e("label",Ne,t(l.$t("video_modal.thumbnail_url")),1),x(e("input",{id:"thumbnail_url",type:"url",placeholder:l.$t("video_modal.thumbnail_url_placeholder"),class:"form-input","onUpdate:modelValue":r[4]||(r[4]=c=>n.value.thumbnail_url=c)},null,8,Te),[[L,n.value.thumbnail_url]]),u.value.thumbnail_url?(i(),d("div",Pe,t(u.value.thumbnail_url[0]),1)):_("",!0)])]),e("div",Re,[e("div",null,[e("label",Ge,t(l.$t("video_modal.duration_seconds")),1),x(e("input",{id:"duration_seconds",type:"number",min:"0",placeholder:l.$t("video_modal.duration_placeholder"),class:"form-input","onUpdate:modelValue":r[5]||(r[5]=c=>n.value.duration_seconds=c),required:""},null,8,Ye),[[L,n.value.duration_seconds]]),n.value.duration_seconds?(i(),d("div",We,t(l.$t("video_modal.duration_helper"))+" "+t(a(n.value.duration_seconds)),1)):_("",!0),u.value.duration_seconds?(i(),d("div",Je,t(u.value.duration_seconds[0]),1)):_("",!0)]),e("div",null,[e("label",Ke,t(l.$t("video_modal.order")),1),x(e("input",{id:"order",type:"number",min:"0",placeholder:l.$t("video_modal.order_placeholder"),class:"form-input","onUpdate:modelValue":r[6]||(r[6]=c=>n.value.order=c)},null,8,Oe),[[L,n.value.order]]),u.value.order?(i(),d("div",Qe,t(u.value.order[0]),1)):_("",!0)]),e("div",null,[e("label",Xe,t(l.$t("video_modal.tags")),1),x(e("input",{id:"tags",type:"text",placeholder:l.$t("video_modal.tags_placeholder"),class:"form-input","onUpdate:modelValue":r[7]||(r[7]=c=>V.value=c)},null,8,Ze),[[L,V.value]]),e("div",et,t(l.$t("video_modal.tags_helper")),1),u.value.tags?(i(),d("div",tt,t(u.value.tags[0]),1)):_("",!0)])]),e("div",st,[e("div",null,[e("label",ot,[x(e("input",{type:"checkbox",class:"form-checkbox","onUpdate:modelValue":r[8]||(r[8]=c=>n.value.is_free=c)},null,512),[[ie,n.value.is_free]]),e("span",lt,t(l.$t("video_modal.is_free")),1)]),e("div",at,t(l.$t("video_modal.is_free_helper")),1)]),e("div",null,[e("label",it,[x(e("input",{type:"checkbox",class:"form-checkbox","onUpdate:modelValue":r[9]||(r[9]=c=>n.value.is_active=c)},null,512),[[ie,n.value.is_active]]),e("span",rt,t(l.$t("video_modal.is_active")),1)]),e("div",dt,t(l.$t("video_modal.is_active_helper")),1)])]),n.value.thumbnail_url?(i(),d("div",nt,[e("label",ut,t(l.$t("video_modal.thumbnail_preview")),1),e("img",{src:n.value.thumbnail_url,alt:"Vista previa",class:"max-w-full h-32 object-cover rounded border",onError:v},null,40,ct)])):_("",!0),e("div",vt,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:h,disabled:w.value},t(l.$t("video_modal.cancel_btn")),9,pt),e("button",{type:"submit",class:"btn btn-primary ltr:ml-4 rtl:mr-4",disabled:w.value},[w.value?(i(),d("span",mt)):_("",!0),F(" "+t(l.video?l.$t("video_modal.update_btn"):l.$t("video_modal.add_btn")),1)],8,_t)])],32)])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}}),gt={class:"fixed inset-0 overflow-y-auto"},ft={class:"flex min-h-full items-center justify-center px-4 py-8"},bt={class:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]"},$t={class:"p-5"},yt={class:"mb-6"},wt={class:"relative bg-black rounded-lg overflow-hidden"},kt={key:0,class:"aspect-video flex items-center justify-center bg-gray-800"},xt={class:"text-center text-white"},Ct={key:1,class:"aspect-video"},Mt=["src"],Vt={key:2,class:"aspect-video"},St=["src"],jt=["poster"],Bt=["src"],Ut={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},At={class:"lg:col-span-2"},It={class:"text-xl font-semibold mb-2"},Lt={key:0,class:"text-gray-600 dark:text-gray-300 mb-4"},Dt={class:"flex flex-wrap gap-2 mb-4"},Et={class:"badge bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},zt={key:0,class:"badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},Ht={key:1,class:"badge bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},Ft={key:2,class:"badge bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},qt={key:3,class:"badge bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},Nt={class:"badge bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},Tt={key:1,class:"mb-4"},Pt={class:"font-medium mb-2"},Rt={class:"flex flex-wrap gap-1"},Gt={class:"lg:col-span-1"},Yt={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},Wt={class:"font-semibold mb-3"},Jt={class:"space-y-2 text-sm"},Kt={class:"flex justify-between"},Ot={class:"text-gray-600 dark:text-gray-400"},Qt={class:"font-mono text-xs"},Xt={class:"flex justify-between"},Zt={class:"text-gray-600 dark:text-gray-400"},es={class:"flex justify-between"},ts={class:"text-gray-600 dark:text-gray-400"},ss={class:"pt-2 border-t dark:border-gray-700"},os=["href"],ls=oe({__name:"VideoPreviewModal",props:{show:{type:Boolean},video:{}},emits:["close"],setup(R,{emit:C}){const{t:I}=le(),f=R,q=C,w=D(()=>{var a,v,h,g;return((v=(a=f.video)==null?void 0:a.video_url)==null?void 0:v.includes("youtube.com"))||((g=(h=f.video)==null?void 0:h.video_url)==null?void 0:g.includes("youtu.be"))}),u=D(()=>{var a,v;return(v=(a=f.video)==null?void 0:a.video_url)==null?void 0:v.includes("vimeo.com")}),V=D(()=>{var h,g,l;if(!((h=f.video)!=null&&h.video_url))return"";let a="";const v=f.video.video_url;return v.includes("youtube.com/watch?v=")?a=((g=v.split("v=")[1])==null?void 0:g.split("&")[0])||"":v.includes("youtu.be/")&&(a=((l=v.split("youtu.be/")[1])==null?void 0:l.split("?")[0])||""),`https://www.youtube.com/embed/${a}?autoplay=1`}),S=D(()=>{var v,h;return(v=f.video)!=null&&v.video_url?`https://player.vimeo.com/video/${((h=f.video.video_url.split("vimeo.com/")[1])==null?void 0:h.split("?")[0])||""}?autoplay=1`:""}),n=a=>{const v=Math.floor(a/3600),h=Math.floor(a%3600/60),g=a%60;return v>0?`${v}:${h.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}`:`${h}:${g.toString().padStart(2,"0")}`},E=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):I("video_preview.not_available"),U=()=>{q("close")};return(a,v)=>(i(),de(y(pe),{appear:"",show:a.show,as:"template"},{default:A(()=>[M(y(ue),{as:"div",onClose:U,class:"relative z-[51]"},{default:A(()=>[M(y(ee),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:A(()=>[M(y(ce),{class:"fixed inset-0 bg-[black]/60"})]),_:1}),e("div",gt,[e("div",ft,[M(y(ee),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:A(()=>[M(y(ve),{class:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-4xl text-black dark:text-white-dark"},{default:A(()=>{var h,g,l,r,c,j,N,B,z,G,Y,T,W,J,P,K;return[e("button",{type:"button",class:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none z-10 bg-white dark:bg-gray-800 rounded-full p-1",onClick:U},[...v[0]||(v[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"w-5 h-5"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),e("div",bt,t((h=a.video)==null?void 0:h.title),1),e("div",$t,[e("div",yt,[e("div",wt,[(g=a.video)!=null&&g.video_url?w.value?(i(),d("div",Ct,[e("iframe",{src:V.value,class:"w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,Mt)])):u.value?(i(),d("div",Vt,[e("iframe",{src:S.value,class:"w-full h-full",frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:""},null,8,St)])):(i(),d("video",{key:3,controls:"",class:"w-full aspect-video",poster:(l=a.video)==null?void 0:l.thumbnail_url},[e("source",{src:(r=a.video)==null?void 0:r.video_url,type:"video/mp4"},null,8,Bt),F(" "+t(a.$t("video_preview.video_unavailable")),1)],8,jt)):(i(),d("div",kt,[e("div",xt,[v[1]||(v[1]=e("svg",{class:"w-16 h-16 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),e("p",null,t(a.$t("video_preview.video_unavailable")),1)])]))])]),e("div",Ut,[e("div",At,[e("h3",It,t((c=a.video)==null?void 0:c.title),1),(j=a.video)!=null&&j.description?(i(),d("p",Lt,t((N=a.video)==null?void 0:N.description),1)):_("",!0),e("div",Dt,[e("span",Et,t(a.$t("video_preview.duration"))+": "+t(n(((B=a.video)==null?void 0:B.duration_seconds)||0)),1),(z=a.video)!=null&&z.is_free?(i(),d("span",zt,t(a.$t("video_preview.free")),1)):(i(),d("span",Ht,t(a.$t("video_preview.paid")),1)),(G=a.video)!=null&&G.is_active?(i(),d("span",Ft,t(a.$t("video_preview.active")),1)):(i(),d("span",qt,t(a.$t("video_preview.inactive")),1)),e("span",Nt,t(a.$t("video_preview.order"))+": "+t(((Y=a.video)==null?void 0:Y.order)||0),1)]),(T=a.video)!=null&&T.tags&&a.video.tags.length>0?(i(),d("div",Tt,[e("h4",Pt,t(a.$t("video_preview.tags"))+":",1),e("div",Rt,[(i(!0),d(Q,null,se(a.video.tags,H=>(i(),d("span",{key:H,class:"badge bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},t(H),1))),128))])])):_("",!0)]),e("div",Gt,[e("div",Yt,[e("h4",Wt,t(a.$t("video_preview.technical_info")),1),e("div",Jt,[e("div",Kt,[e("span",Ot,t(a.$t("video_preview.slug"))+":",1),e("span",Qt,t((W=a.video)==null?void 0:W.slug),1)]),e("div",Xt,[e("span",Zt,t(a.$t("video_preview.created"))+":",1),e("span",null,t(E((J=a.video)==null?void 0:J.created_at)),1)]),e("div",es,[e("span",ts,t(a.$t("video_preview.updated"))+":",1),e("span",null,t(E((P=a.video)==null?void 0:P.updated_at)),1)]),e("div",ss,[e("a",{href:(K=a.video)==null?void 0:K.video_url,target:"_blank",class:"btn btn-outline-primary btn-sm w-full"},[v[2]||(v[2]=e("svg",{class:"w-4 h-4 ltr:mr-1 rtl:ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)),F(" "+t(a.$t("video_preview.open_new_tab")),1)],8,os)])])])])])])]}),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}}),as=ne(ls,[["__scopeId","data-v-fa3dacdc"]]),is={class:"p-6"},rs={class:"flex items-center justify-between mb-6"},ds={class:"flex items-center gap-4"},ns={class:"text-2xl font-bold"},us={class:"text-gray-600"},cs={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},vs={class:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-4 text-white"},ps={class:"text-2xl font-bold"},_s={class:"text-sm"},ms={class:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-4 text-white"},hs={class:"text-2xl font-bold"},gs={class:"text-sm"},fs={class:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-4 text-white"},bs={class:"text-2xl font-bold"},$s={class:"text-sm"},ys={class:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-4 text-white"},ws={class:"text-2xl font-bold"},ks={class:"text-sm"},xs={key:0,class:"alert alert-danger alert-dismissible fade show mb-4",role:"alert"},Cs={key:1,class:"alert alert-success alert-dismissible fade show mb-4",role:"alert"},Ms={class:"flex flex-col md:flex-row gap-4 mb-6"},Vs={class:"flex-1"},Ss=["placeholder"],js={class:"flex gap-2"},Bs={value:""},Us={value:"active"},As={value:"inactive"},Is={value:""},Ls={value:"free"},Ds={value:"paid"},Es={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"},zs={class:"relative"},Hs=["src","alt"],Fs={class:"absolute top-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-sm"},qs={class:"absolute bottom-2 left-2 flex gap-1"},Ns={key:0,class:"badge bg-green-500 text-white"},Ts={key:1,class:"badge bg-red-500 text-white"},Ps={class:"p-4"},Rs={class:"font-semibold text-lg mb-2 line-clamp-2"},Gs={class:"text-gray-600 text-sm mb-3 line-clamp-2"},Ys={class:"flex justify-between items-center text-sm text-gray-500 mb-3"},Ws={class:"flex gap-2"},Js=["onClick"],Ks=["onClick","title"],Os=["onClick","title"],Qs={key:0,class:"col-span-full text-center py-12"},Xs={class:"mt-4 text-lg font-medium"},Zs={class:"mt-1 text-gray-500"},eo={key:2,class:"flex justify-center mt-8 mb-4"},to={class:"ml-2"},so={key:3,class:"fixed bottom-6 right-6 z-50 md:hidden"},oo=["title"],lo=oe({__name:"ServiceVideos",setup(R){const{t:C}=le(),I=me();ge();const f=fe(),q=$(I.params.serviceId),w=$(null),u=$([]),V=$(!1),S=$(""),n=$(""),E=$(""),U=$(""),a=$(""),v=$(!1),h=$(!1),g=$(null),l=$(null),r=D(()=>u.value.filter(s=>{const o=(s==null?void 0:s.title)||"",m=(s==null?void 0:s.description)||"",b=E.value.toLowerCase(),k=o.toLowerCase().includes(b)||m.toLowerCase().includes(b),p=U.value===""||U.value==="active"&&s.is_active||U.value==="inactive"&&!s.is_active,O=a.value===""||a.value==="free"&&s.is_free||a.value==="paid"&&!s.is_free;return k&&p&&O})),c=D(()=>u.value.filter(s=>s.is_active).length),j=D(()=>u.value.filter(s=>s.is_free).length),N=D(()=>{const s=u.value.reduce((b,k)=>b+(k.duration_seconds||0),0),o=Math.floor(s/3600),m=Math.floor(s%3600/60);return`${o}h ${m}m`});he(()=>{B()});const B=async()=>{var s,o;V.value=!0;try{const m=await X.get(`/api/services/${q.value}`);w.value=m.data,u.value=Array.isArray(m.data.videos)?m.data.videos:[]}catch(m){console.error("Error fetching service and videos:",m),S.value=((o=(s=m.response)==null?void 0:s.data)==null?void 0:o.message)||"Error al cargar los datos del servicio.",H(S.value,"error")}finally{V.value=!1}},z=s=>{const o=Math.floor(s/3600),m=Math.floor(s%3600/60),b=s%60;return o>0?`${o}h ${m.toString().padStart(2,"0")}m ${b.toString().padStart(2,"0")}s`:m>0?`${m}m ${b.toString().padStart(2,"0")}s`:`${b}s`},G=s=>s?new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"N/A",Y=s=>{const o=s.target;o.src="/assets/images/video-placeholder.jpg"},T=(s=null)=>{g.value=s,v.value=!0},W=s=>{l.value=s,h.value=!0},J=async s=>{var m,b;if((await Z.fire({title:C("videos_page.delete_confirm_title"),text:C("videos_page.delete_confirm_text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:C("videos_page.delete_confirm_yes"),cancelButtonText:C("videos_page.delete_confirm_cancel")})).isConfirmed)try{await X.delete(`/api/videos/${s.id}`),u.value=u.value.filter(k=>k.id!==s.id),H(C("videos_page.delete_success"),"success")}catch(k){console.error("Error deleting video:",k),H(((b=(m=k.response)==null?void 0:m.data)==null?void 0:b.message)||C("videos_page.delete_error"),"error")}},P=()=>{v.value=!1,g.value=null},K=s=>{const o=s.data;if(console.log("Video guardado:",o),g.value&&o.id){const b=u.value.findIndex(k=>k.id===o.id);b!==-1?u.value.splice(b,1,o):u.value.unshift(o)}else o.id&&u.value.unshift(o);P();const m=g.value?C("videos_page.update_success"):C("videos_page.create_success");H(m,"success")},H=(s="",o="success")=>{o==="success"?n.value=s:S.value=s,Z.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,customClass:{container:"toast"}}).fire({icon:o,title:s,padding:"10px 20px"})},ae=()=>{var s;(s=w.value)!=null&&s.whatsapp_url?window.open(w.value.whatsapp_url,"_blank","noopener,noreferrer"):H("URL de WhatsApp no disponible","error")};return(s,o)=>{var m,b,k;return i(),d("div",is,[e("div",rs,[e("div",ds,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:o[0]||(o[0]=p=>s.$router.back())},[o[9]||(o[9]=e("svg",{class:"w-4 h-4 ltr:mr-2 rtl:ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),F(" "+t(s.$t("videos_page.back_btn")),1)]),e("div",null,[e("h2",ns,t(s.$t("videos_page.title")),1),e("p",us,t((m=w.value)==null?void 0:m.name),1)])]),y(f).can("create videos")?(i(),d("button",{key:0,type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=p=>T())},[o[10]||(o[10]=e("svg",{class:"w-5 h-5 ltr:mr-2 rtl:ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)),F(" "+t(s.$t("videos_page.add_video_btn")),1)])):_("",!0)]),e("div",cs,[e("div",vs,[e("div",ps,t(u.value.length),1),e("div",_s,t(s.$t("videos_page.total_videos")),1)]),e("div",ms,[e("div",hs,t(c.value),1),e("div",gs,t(s.$t("videos_page.active_videos")),1)]),e("div",fs,[e("div",bs,t(j.value),1),e("div",$s,t(s.$t("videos_page.free_videos")),1)]),e("div",ys,[e("div",ws,t(N.value),1),e("div",ks,t(s.$t("videos_page.total_duration")),1)])]),S.value?(i(),d("div",xs,[o[11]||(o[11]=e("i",{class:"ri-error-warning-line me-2"},null,-1)),F(" "+t(S.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:o[2]||(o[2]=p=>S.value="")})])):_("",!0),n.value?(i(),d("div",Cs,[o[12]||(o[12]=e("i",{class:"ri-checkbox-circle-line me-2"},null,-1)),F(" "+t(n.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:o[3]||(o[3]=p=>n.value="")})])):_("",!0),e("div",Ms,[e("div",Vs,[x(e("input",{type:"text",placeholder:s.$t("videos_page.search_placeholder"),class:"form-input w-full","onUpdate:modelValue":o[4]||(o[4]=p=>E.value=p)},null,8,Ss),[[L,E.value]])]),e("div",js,[x(e("select",{"onUpdate:modelValue":o[5]||(o[5]=p=>U.value=p),class:"form-select"},[e("option",Bs,t(s.$t("videos_page.all_statuses")),1),e("option",Us,t(s.$t("videos_page.active")),1),e("option",As,t(s.$t("videos_page.inactive")),1)],512),[[re,U.value]]),x(e("select",{"onUpdate:modelValue":o[6]||(o[6]=p=>a.value=p),class:"form-select"},[e("option",Is,t(s.$t("videos_page.all_types")),1),e("option",Ls,t(s.$t("videos_page.free")),1),e("option",Ds,t(s.$t("videos_page.paid")),1)],512),[[re,a.value]])])]),e("div",Es,[V.value?(i(),d(Q,{key:0},se(6,p=>e("div",{key:p,class:"bg-white dark:bg-gray-800 rounded-lg shadow animate-pulse"},[...o[13]||(o[13]=[e("div",{class:"h-48 bg-gray-300 rounded-t-lg"},null,-1),e("div",{class:"p-4"},[e("div",{class:"h-4 bg-gray-300 rounded mb-2"}),e("div",{class:"h-3 bg-gray-300 rounded w-3/4"})],-1)])])),64)):(i(),d(Q,{key:1},[(i(!0),d(Q,null,se(r.value,p=>(i(),d("div",{key:p.id,class:"bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-lg transition-shadow"},[e("div",zs,[e("img",{src:p.thumbnail_url||"/assets/images/video-placeholder.jpg",alt:p.title,class:"w-full h-48 object-cover rounded-t-lg",onError:Y},null,40,Hs),e("div",Fs,t(z(p.duration_seconds)),1),e("div",qs,[p.is_free?(i(),d("span",Ns,t(s.$t("videos_page.free")),1)):_("",!0),p.is_active?_("",!0):(i(),d("span",Ts,t(s.$t("videos_page.inactive")),1))])]),e("div",Ps,[e("h3",Rs,t(p.title),1),e("p",Gs,t(p.description),1),e("div",Ys,[e("span",null,t(s.$t("videos_page.order"))+": "+t(p.order),1),e("span",null,t(G(p.created_at)),1)]),e("div",Ws,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm flex-1",onClick:O=>W(p)},[o[14]||(o[14]=e("svg",{class:"w-4 h-4 ltr:mr-1 rtl:ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),F(" "+t(s.$t("videos_page.view_btn")),1)],8,Js),y(f).can("edit videos")?(i(),d("button",{key:0,type:"button",class:"btn btn-outline-secondary btn-sm",onClick:O=>T(p),title:s.$t("videos_page.edit_tooltip")},[...o[15]||(o[15]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Ks)):_("",!0),y(f).can("delete videos")?(i(),d("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm",onClick:O=>J(p),title:s.$t("videos_page.delete_tooltip")},[...o[16]||(o[16]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Os)):_("",!0)])])]))),128)),r.value.length===0?(i(),d("div",Qs,[o[17]||(o[17]=e("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),e("h3",Xs,t(s.$t("videos_page.no_videos_title")),1),e("p",Zs,t(s.$t("videos_page.no_videos_description")),1),y(f).can("create videos")?(i(),d("button",{key:0,type:"button",class:"btn btn-primary mt-4",onClick:o[7]||(o[7]=p=>T())},t(s.$t("videos_page.add_first_video_btn")),1)):_("",!0)])):_("",!0)],64))]),(b=w.value)!=null&&b.whatsapp_url?(i(),d("div",eo,[e("button",{type:"button",class:"btn btn-success btn-lg",onClick:ae},[o[18]||(o[18]=e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893c0-3.18-1.24-6.169-3.495-8.418"})],-1)),e("span",to,t(s.$t("videos_page.whatsapp_btn")),1)])])):_("",!0),(k=w.value)!=null&&k.whatsapp_url?(i(),d("div",so,[e("button",{type:"button",class:"btn btn-success btn-circle shadow-lg",onClick:ae,title:s.$t("videos_page.whatsapp_tooltip")},[...o[19]||(o[19]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893c0-3.18-1.24-6.169-3.495-8.418"})],-1)])],8,oo)])):_("",!0),M(ht,{show:v.value,video:g.value,"service-id":q.value,onClose:P,onSaved:K},null,8,["show","video","service-id"]),M(as,{show:h.value,video:l.value,onClose:o[8]||(o[8]=p=>h.value=!1)},null,8,["show","video"])])}}}),_o=ne(lo,[["__scopeId","data-v-6c16d208"]]);export{_o as default};
