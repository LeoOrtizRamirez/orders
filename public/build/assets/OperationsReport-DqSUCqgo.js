import{d as R,r as c,c as p,o as A,k as o,l as r,m as t,x as v,A as m,a2 as w,K as T,F as U,D as P,C as z,t as D,f as g,u as f}from"./vendor-CjqaLWPm.js";import{u as I,a as j,d as H}from"./main-C4NWlK8k.js";import{m as x}from"./vue3-apexcharts-jKmFL5Us.js";import"./quill-De1S0mUZ.js";const L={class:"panel mb-6"},q={class:"flex flex-wrap items-end gap-4 justify-between"},K={class:"flex flex-wrap gap-4 flex-1"},G={class:"flex gap-2"},J={class:"flex flex-wrap gap-4 flex-1 justify-end"},Q={class:"w-48"},W=["value"],X={key:0,class:"text-center"},Y={key:1,class:"alert alert-danger"},Z={key:2,class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},$={class:"panel"},ee={key:0},te={key:1,class:"text-center py-10 text-gray-500"},se={class:"panel"},ae={key:0},oe={key:1,class:"text-center py-10 text-gray-500"},re={class:"panel lg:col-span-2"},le={key:0},ne={key:1,class:"text-center py-10 text-gray-500"},he=R({__name:"OperationsReport",setup(ie){I({title:"Reporte de Operaciones"});const d=j(),h=c(!0),u=c(""),a=c(null),C=new Date().toISOString().split("T")[0],M=new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],l=c({startDate:M,endDate:C,status:""}),S={"nuevo pedido":"Nuevo Pedido",disponibilidad:"Disponibilidad","preparar pedido":"Preparar Pedido","en preparación":"En Preparación",facturación:"Facturación","en despacho":"En Despacho","en ruta":"En Ruta",entregado:"Entregado",cancelado:"Cancelado"},y=async()=>{h.value=!0,u.value="";try{const s=await H.get("/api/reports/sales",{params:{start_date:l.value.startDate,end_date:l.value.endDate,order_status:l.value.status}});a.value=s.data}catch(s){u.value="No se pudieron cargar los datos del reporte.",console.error(s)}finally{h.value=!1}},O=p(()=>{var e;const s=d.theme==="dark"||d.isDarkMode;return{chart:{type:"pie",height:300},labels:((e=a.value)==null?void 0:e.orders_by_status.map(n=>n.status.charAt(0).toUpperCase()+n.status.slice(1)))||[],colors:["#2196f3","#00ab55","#e2a03f","#e7515a","#805dca","#4361ee"],stroke:{show:!0,colors:s?"#0e1726":"#fff"},legend:{position:"bottom"},responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]}}),N=p(()=>{var s;return((s=a.value)==null?void 0:s.orders_by_status.map(e=>e.total))||[]}),E=p(()=>{var e;const s=d.theme==="dark"||d.isDarkMode;return{chart:{type:"bar",height:300,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0}},colors:["#00ab55"],xaxis:{categories:((e=a.value)==null?void 0:e.top_suppliers.map(n=>n.name))||[],axisBorder:{color:s?"#191e3a":"#e0e6ed"}},grid:{borderColor:s?"#191e3a":"#e0e6ed"},tooltip:{theme:s?"dark":"light"}}}),F=p(()=>{var s;return[{name:"Órdenes",data:((s=a.value)==null?void 0:s.top_suppliers.map(e=>e.total_orders))||[]}]}),V=p(()=>{var e;const s=d.theme==="dark"||d.isDarkMode;return{chart:{type:"bar",height:300,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0}},colors:["#805dca"],xaxis:{categories:((e=a.value)==null?void 0:e.top_creators.map(n=>n.name))||[],axisBorder:{color:s?"#191e3a":"#e0e6ed"}},grid:{borderColor:s?"#191e3a":"#e0e6ed"},tooltip:{theme:s?"dark":"light"}}}),B=p(()=>{var s;return[{name:"Órdenes Creadas",data:((s=a.value)==null?void 0:s.top_creators.map(e=>e.total_orders))||[]}]});return A(()=>{y()}),(s,e)=>{var n,b,_;return r(),o("div",null,[e[10]||(e[10]=t("div",{class:"mb-6"},[t("h1",{class:"text-3xl font-bold"},"Reporte de Operaciones"),t("p",{class:"text-gray-500"},"Métricas de eficiencia, proveedores y equipo.")],-1)),t("div",L,[t("div",q,[t("div",K,[t("div",null,[e[3]||(e[3]=t("label",{class:"font-bold text-xs mb-1 block"},"Rango de Fechas",-1)),t("div",G,[m(t("input",{type:"date",class:"form-input w-40","onUpdate:modelValue":e[0]||(e[0]=i=>l.value.startDate=i),title:"Fecha Inicio"},null,512),[[w,l.value.startDate]]),m(t("input",{type:"date",class:"form-input w-40","onUpdate:modelValue":e[1]||(e[1]=i=>l.value.endDate=i),title:"Fecha Fin"},null,512),[[w,l.value.endDate]])])])]),t("div",J,[t("div",Q,[e[5]||(e[5]=t("label",{for:"status",class:"font-bold text-xs mb-1 block"},"Estado Orden",-1)),m(t("select",{id:"status",class:"form-select","onUpdate:modelValue":e[2]||(e[2]=i=>l.value.status=i)},[e[4]||(e[4]=t("option",{value:""},"Todos los Estados",-1)),(r(),o(U,null,P(S,(i,k)=>t("option",{key:k,value:k},D(i),9,W)),64))],512),[[T,l.value.status]])]),t("div",{class:"flex items-end"},[t("button",{class:"btn btn-primary",onClick:y},[...e[6]||(e[6]=[z('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 ltr:mr-2 rtl:ml-2"><path opacity="0.5" d="M14 5H20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><path opacity="0.5" d="M14 8H17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><path d="M21 11.5C21 16.75 16.75 21 11.5 21C6.25 21 2 16.75 2 11.5C2 6.25 6.25 2 11.5 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><path opacity="0.5" d="M22 22L20 20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg> Actualizar ',2)])])])])])]),h.value?(r(),o("div",X,"Cargando datos...")):v("",!0),u.value?(r(),o("div",Y,D(u.value),1)):v("",!0),a.value?(r(),o("div",Z,[t("div",$,[e[7]||(e[7]=t("h2",{class:"text-xl font-bold mb-4"},"Estado de Órdenes",-1)),(n=a.value.orders_by_status)!=null&&n.length?(r(),o("div",ee,[g(f(x),{height:"300",type:"pie",options:O.value,series:N.value},null,8,["options","series"])])):(r(),o("div",te,"No hay órdenes en este periodo"))]),t("div",se,[e[8]||(e[8]=t("h2",{class:"text-xl font-bold mb-4"},"Top 5 Clientes (Órdenes)",-1)),(b=a.value.top_suppliers)!=null&&b.length?(r(),o("div",ae,[g(f(x),{height:"300",type:"bar",options:E.value,series:F.value},null,8,["options","series"])])):(r(),o("div",oe,"No hay datos de clientes"))]),t("div",re,[e[9]||(e[9]=t("h2",{class:"text-xl font-bold mb-4"},"Órdenes Creadas por Usuario",-1)),(_=a.value.top_creators)!=null&&_.length?(r(),o("div",le,[g(f(x),{height:"300",type:"bar",options:V.value,series:B.value},null,8,["options","series"])])):(r(),o("div",ne,"No hay datos de usuarios"))])])):v("",!0)])}}});export{he as default};
