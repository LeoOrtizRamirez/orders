import{d as B,r as d,o as R,c as v,k as o,l,m as e,x as h,A as m,a2 as b,K as I,F as k,D as x,C as O,t as u,f as _,u as w}from"./vendor-CjqaLWPm.js";import{u as U,a as j,d as D}from"./main-WEZQHFWb.js";import{m as C}from"./vue3-apexcharts-jKmFL5Us.js";import"./quill-De1S0mUZ.js";const q={class:"panel mb-6"},E={class:"flex flex-wrap items-end gap-4 justify-between"},H={class:"flex flex-wrap gap-4 flex-1"},K={class:"flex gap-2"},L={class:"flex flex-wrap gap-4 flex-1 justify-end"},P={class:"w-48"},z=["value"],G={key:0,class:"text-center"},J={key:1,class:"alert alert-danger"},Q={key:2},W={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},X={class:"panel lg:col-span-2"},Y={class:"panel"},Z={key:0},$={key:1,class:"text-center py-10 text-gray-500"},ee={class:"panel"},te={class:"table-responsive"},se={class:"table-hover"},ie=B({__name:"SalesDashboard",setup(ae){U({title:"Reporte de Ventas"});const c=j(),g=d(!0),p=d(""),n=d(null),y=d([]),V=new Date().toISOString().split("T")[0],S=new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],r=d({startDate:S,endDate:V,category:""}),M=async()=>{try{const s=await D.get("/api/products/categories");y.value=s.data.data}catch(s){console.error("Error fetching categories",s)}},f=async()=>{g.value=!0,p.value="";try{const s=await D.get("/api/reports/sales",{params:{start_date:r.value.startDate,end_date:r.value.endDate,category:r.value.category}});n.value=s.data}catch(s){p.value="No se pudieron cargar los datos del reporte.",console.error(s)}finally{g.value=!1}};R(()=>{M(),f()});const F=v(()=>{var t;const s=c.theme==="dark"||c.isDarkMode;return{chart:{type:"line",height:300,toolbar:{show:!1}},colors:["#194C8D"],stroke:{width:2,curve:"smooth"},xaxis:{categories:((t=n.value)==null?void 0:t.sales_over_time.map(i=>i.date))||[],axisBorder:{color:s?"#191e3a":"#e0e6ed"}},yaxis:{labels:{formatter:i=>i.toFixed(0)}},grid:{borderColor:s?"#191e3a":"#e0e6ed"},tooltip:{theme:s?"dark":"light"}}}),T=v(()=>{var s;return[{name:"Cantidad Vendida",data:((s=n.value)==null?void 0:s.sales_over_time.map(t=>t.total_quantity))||[]}]}),N=v(()=>{var t;const s=c.theme==="dark"||c.isDarkMode;return{chart:{type:"pie",height:300},labels:((t=n.value)==null?void 0:t.sales_by_category.map(i=>i.category))||[],colors:["#4361ee","#805dca","#00ab55","#e7515a","#e2a03f","#2196f3"],stroke:{show:!0,colors:s?"#0e1726":"#fff"},legend:{position:"bottom"},responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]}}),A=v(()=>{var s;return((s=n.value)==null?void 0:s.sales_by_category.map(t=>parseInt(t.total_quantity)))||[]});return(s,t)=>{var i;return l(),o("div",null,[t[11]||(t[11]=e("div",{class:"mb-6"},[e("h1",{class:"text-3xl font-bold"},"Reporte de Ventas"),e("p",{class:"text-gray-500"},"Análisis de productos vendidos y tendencias.")],-1)),e("div",q,[e("div",E,[e("div",H,[e("div",null,[t[3]||(t[3]=e("label",{class:"font-bold text-xs mb-1 block"},"Rango de Fechas",-1)),e("div",K,[m(e("input",{type:"date",class:"form-input w-40","onUpdate:modelValue":t[0]||(t[0]=a=>r.value.startDate=a),title:"Fecha Inicio"},null,512),[[b,r.value.startDate]]),m(e("input",{type:"date",class:"form-input w-40","onUpdate:modelValue":t[1]||(t[1]=a=>r.value.endDate=a),title:"Fecha Fin"},null,512),[[b,r.value.endDate]])])])]),e("div",L,[e("div",P,[t[5]||(t[5]=e("label",{for:"category",class:"font-bold text-xs mb-1 block"},"Filtrar por Categoría",-1)),m(e("select",{id:"category",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=a=>r.value.category=a)},[t[4]||(t[4]=e("option",{value:""},"Todas las Categorías",-1)),(l(!0),o(k,null,x(y.value,a=>(l(),o("option",{key:a.id,value:a.id},u(a.name),9,z))),128))],512),[[I,r.value.category]])]),e("div",{class:"flex items-end"},[e("button",{class:"btn btn-primary",onClick:f},[...t[6]||(t[6]=[O('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 ltr:mr-2 rtl:ml-2"><path opacity="0.5" d="M14 5H20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><path opacity="0.5" d="M14 8H17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><path d="M21 11.5C21 16.75 16.75 21 11.5 21C6.25 21 2 16.75 2 11.5C2 6.25 6.25 2 11.5 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><path opacity="0.5" d="M22 22L20 20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg> Actualizar Reporte ',2)])])])])])]),g.value?(l(),o("div",G,"Cargando datos...")):h("",!0),p.value?(l(),o("div",J,u(p.value),1)):h("",!0),n.value?(l(),o("div",Q,[e("div",W,[e("div",X,[t[7]||(t[7]=e("h2",{class:"text-xl font-bold mb-4"},"Tendencia de Ventas (Cantidad)",-1)),_(w(C),{height:"300",options:F.value,series:T.value,class:"bg-white dark:bg-black rounded-lg overflow-hidden"},null,8,["options","series"])]),e("div",Y,[t[8]||(t[8]=e("h2",{class:"text-xl font-bold mb-4"},"Ventas por Categoría",-1)),(i=n.value.sales_by_category)!=null&&i.length?(l(),o("div",Z,[_(w(C),{height:"300",type:"pie",options:N.value,series:A.value},null,8,["options","series"])])):(l(),o("div",$,"No hay datos de ventas en este periodo"))]),e("div",ee,[t[10]||(t[10]=e("h2",{class:"text-xl font-bold mb-4"},"Top 10 Productos Más Vendidos",-1)),e("div",te,[e("table",se,[t[9]||(t[9]=e("thead",null,[e("tr",null,[e("th",null,"SKU"),e("th",null,"Producto"),e("th",null,"Total Vendido")])],-1)),e("tbody",null,[(l(!0),o(k,null,x(n.value.top_sold_products,a=>(l(),o("tr",{key:a.id},[e("td",null,u(a.sku),1),e("td",null,u(a.name),1),e("td",null,u(a.total_sold),1)]))),128))])])])])])])):h("",!0)])}}});export{ie as default};
