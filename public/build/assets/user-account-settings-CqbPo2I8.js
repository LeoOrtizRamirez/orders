import{d as O,r as m,z as M,c as T,o as W,G as q,k as d,l as u,m as e,t as r,x as c,P as F,q as b,f as w,u as v,n as S,y as $,a3 as B,A as y,a2 as k}from"./vendor-BuRU_kNN.js";import{u as G,b as H,c as N,_ as Z}from"./main-Ck4yvBPR.js";import{S as J}from"./sweetalert2.esm.all-5zhdP7Ax.js";import{x as D,p as K,y as z,I as Q,m as X}from"./tabs-C3xeTNFm.js";import"./quill-De1S0mUZ.js";import"./keyboard-CA3kR_KZ.js";import"./use-resolve-button-type-CHQr93im.js";import"./hidden-CJVN9Aon.js";const Y={class:"flex space-x-2 rtl:space-x-reverse"},ee={class:"ltr:before:mr-2 rtl:before:ml-2"},se={class:"pt-5"},te={class:"flex items-center justify-between mb-5"},ae={class:"font-semibold text-lg dark:text-white-light"},re={key:0,class:"text-center py-10"},oe={class:"text-lg font-bold mb-5"},le={class:"flex flex-col sm:flex-row"},ne={class:"ltr:sm:mr-4 rtl:sm:ml-4 w-full sm:w-2/12 mb-5"},ie=["src"],ue={class:"mt-3 flex flex-col gap-2"},de={key:0,class:"text-danger mt-1 text-center"},ce={class:"flex-1 grid grid-cols-1 sm:grid-cols-2 gap-5"},pe={for:"name"},me=["placeholder"],ge={key:0,class:"text-danger mt-1"},fe={for:"phone"},_e=["placeholder"],be={key:0,class:"text-danger mt-1"},ve={for:"email"},he=["placeholder"],we={key:0,class:"text-danger mt-1"},ye={for:"password"},ke=["placeholder"],xe={key:0,class:"text-danger mt-1"},$e={class:"sm:col-span-2 mt-3"},Ce=["disabled"],Ue={key:0,class:"animate-spin border-2 border-white border-l-transparent rounded-full w-4 h-4 ltr:mr-2 rtl:ml-2 inline-block"},Ie={class:"text-lg font-bold mb-5"},Ve={class:"flex flex-col sm:flex-row"},Ne={class:"flex-1 grid grid-cols-1 sm:grid-cols-2 gap-5"},je={for:"user_name"},Me=["placeholder"],Se={key:0,class:"text-danger mt-1"},Be={for:"user_only_password"},De=["placeholder"],ze={key:0,class:"text-danger mt-1"},Ee={class:"sm:col-span-2 mt-3"},Le=["disabled"],Pe={key:0,class:"animate-spin border-2 border-white border-l-transparent rounded-full w-4 h-4 ltr:mr-2 rtl:ml-2 inline-block"},Re={class:"switch"},Ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-5 mb-5"},Oe={class:"panel space-y-5"},Te={class:"font-semibold text-lg mb-4"},We={class:"grid grid-cols-1 md:grid-cols-3 gap-5"},qe={class:"panel space-y-5"},Fe={class:"font-semibold text-lg mb-4"},Ge=O({__name:"user-account-settings",setup(He){G({title:"Account Setting"});const i=H(),V=q(),C=m(!0),U=m(!1),I=m(!1),h=m(""),o=m({}),l=m(null),x=m(null),p=m(null),n=M({name:"",email:"",phone:"",password:""}),g=M({user_name:"",password:""}),E=T(()=>{var t;return p.value?URL.createObjectURL(p.value):(t=l.value)!=null&&t.image?l.value.image.startsWith("http")?l.value.image:l.value.image.startsWith("storage/")?`/${l.value.image}`:`/storage/${l.value.image}`:"/assets/images/profile-34.jpeg"});W(async()=>{await j()});const j=async()=>{var t;C.value=!0,h.value="";try{const s=V.params.id||((t=i.user)==null?void 0:t.id);if(!s)throw new Error("No se pudo identificar el usuario");const a=await N.get(`/api/users/${s}`);l.value=a.data,i.user&&i.user.id===parseInt(s)&&i.setUser(a.data),n.name=l.value.name||"",n.email=l.value.email||"",n.phone=l.value.phone||"",n.password=l.value.password||"",l.value.user_only&&(g.user_name=l.value.user_only.user_name||"",g.password=l.value.user_only.user_password||"")}catch(s){console.error("Error al cargar datos del usuario:",s),h.value="No se pudieron cargar los datos del usuario.",f("Error al cargar datos del usuario","error")}finally{C.value=!1}},L=t=>{const s=t.target;if(s.files&&s.files[0]){const a=s.files[0];if(!a.type.startsWith("image/")){f("Por favor selecciona una imagen válida","error"),s.value="";return}if(a.size>2*1024*1024){f("La imagen no debe exceder 2MB","error"),s.value="";return}p.value=a}},P=async()=>{var t;U.value=!0,o.value={};try{const s=V.params.id||((t=i.user)==null?void 0:t.id),a=new FormData;a.append("name",n.name),a.append("email",n.email),a.append("phone",n.phone),n.password&&a.append("password",n.password),p.value&&a.append("image",p.value);const _=await N.post(`/api/users/${s}`,a,{headers:{"Content-Type":"multipart/form-data"}});l.value=_.data,i.user&&i.user.id===parseInt(s)&&i.updateUser({name:_.data.name,email:_.data.email,phone:_.data.phone,image:_.data.image}),p.value=null,x.value&&(x.value.value=""),f("Usuario actualizado satisfactoriamente!","success"),await j()}catch(s){s.response&&s.response.status===422?(o.value=s.response.data.errors,h.value="Por favor corrija los errores de validación."):(console.error("Error al guardar usuario:",s),h.value="No se pudo guardar el usuario. Inténtalo de nuevo.",f("No se pudo guardar el usuario.","error"))}finally{U.value=!1}},R=async()=>{var t;I.value=!0,o.value={};try{const s=V.params.id||((t=i.user)==null?void 0:t.id),a=await N.put(`/api/user-only/${s}`,g);if(l.value&&(l.value.user_only=a.data),i.user&&i.user.id===parseInt(s)){const _={...i.user,user_only:a.data};i.setUser(_)}f("Usuario only actualizado satisfactoriamente!","success")}catch(s){s.response&&s.response.status===422?(o.value=s.response.data.errors,h.value="Por favor corrija los errores de validación."):(console.error("Error al guardar usuario only:",s),h.value="No se pudo guardar el usuario only. Inténtalo de nuevo.",f("No se pudo guardar el usuario only.","error"))}finally{I.value=!1}},f=(t="",s="success")=>{J.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,customClass:{container:"toast"}}).fire({icon:s,title:t,padding:"10px 20px"})},A=()=>{p.value=null,x.value&&(x.value.value="")};return(t,s)=>(u(),d("div",null,[e("ul",Y,[e("li",ee,[e("span",null,r(t.$t("user_account_settings.nav.account_settings")),1)])]),e("div",se,[e("div",te,[e("h5",ae,r(t.$t("user_account_settings.title")),1)]),C.value?(u(),d("div",re,[...s[7]||(s[7]=[e("div",{class:"animate-spin border-2 border-primary border-l-transparent rounded-full w-8 h-8 mx-auto"},null,-1),e("p",{class:"mt-2"},"Cargando datos del usuario...",-1)])])):c("",!0),C.value?c("",!0):(u(),F(v(X),{key:1},{default:b(()=>[w(v(K),{class:"flex font-semibold border-b border-[#ebedf2] dark:border-[#191e3a] mb-5 whitespace-nowrap overflow-y-auto"},{default:b(()=>[w(v(D),{as:"template"},{default:b(({selected:a})=>[e("a",{href:"javascript:;",class:S(["flex gap-2 p-4 border-b border-transparent hover:border-primary hover:text-primary !outline-none",{"!border-primary text-primary":a}])},[s[8]||(s[8]=e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5"},[e("path",{opacity:"0.5",d:"M2 12.2039C2 9.91549 2 8.77128 2.5192 7.82274C3.0384 6.87421 3.98695 6.28551 5.88403 5.10813L7.88403 3.86687C9.88939 2.62229 10.8921 2 12 2C13.1079 2 14.1106 2.62229 16.116 3.86687L18.116 5.10812C20.0131 6.28551 20.9616 6.87421 21.4808 7.82274C22 8.77128 22 9.91549 22 12.2039V13.725C22 17.6258 22 19.5763 20.8284 20.7881C19.6569 22 17.7712 22 14 22H10C6.22876 22 4.34315 22 3.17157 20.7881C2 19.5763 2 17.6258 2 13.725V12.2039Z",stroke:"currentColor","stroke-width":"1.5"}),e("path",{d:"M12 15L12 18",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"})],-1)),$(" "+r(t.$t("user_account_settings.tabs.settings.title")),1)],2)]),_:1}),w(v(D),{as:"template"},{default:b(({selected:a})=>[e("a",{href:"javascript:;",class:S(["flex gap-2 p-4 border-b border-transparent hover:border-primary hover:text-primary !outline-none",{"!border-primary text-primary":a}])},[s[9]||(s[9]=e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5"},[e("circle",{cx:"12",cy:"6",r:"4",stroke:"currentColor","stroke-width":"1.5"}),e("ellipse",{opacity:"0.5",cx:"12",cy:"17",rx:"7",ry:"4",stroke:"currentColor","stroke-width":"1.5"})],-1)),$(" "+r(t.$t("user_account_settings.tabs.preferences.title")),1)],2)]),_:1})]),_:1}),w(v(Q),null,{default:b(()=>[w(v(z),null,{default:b(()=>[e("div",null,[e("form",{onSubmit:B(P,["prevent"]),class:"border border-[#ebedf2] dark:border-[#191e3a] rounded-md p-4 mb-5 bg-white dark:bg-[#0e1726]"},[e("h6",oe,r(t.$t("user_account_settings.tabs.settings.account.title")),1),e("div",le,[e("div",ne,[e("img",{src:E.value,alt:"User avatar",class:"w-20 h-20 md:w-32 md:h-32 rounded-full object-cover mx-auto"},null,8,ie),e("input",{type:"file",ref_key:"imageInput",ref:x,name:"image",accept:"image/*",onChange:L,class:"hidden"},null,544),e("div",ue,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.$refs.imageInput.click()),class:"btn btn-outline-primary btn-sm w-full"},r(t.$t("user_account_settings.tabs.settings.account.change_image")),1),p.value?(u(),d("button",{key:0,type:"button",onClick:A,class:"btn btn-outline-danger btn-sm w-full"}," Cancelar ")):c("",!0)]),o.value.image?(u(),d("div",de,r(o.value.image[0]),1)):c("",!0)]),e("div",ce,[e("div",null,[e("label",pe,r(t.$t("user_account_settings.tabs.settings.account.full_name")),1),y(e("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=a=>n.name=a),type:"text",placeholder:t.$t("user_account_settings.tabs.settings.account.full_name"),class:"form-input"},null,8,me),[[k,n.name]]),o.value.name?(u(),d("div",ge,r(o.value.name[0]),1)):c("",!0)]),e("div",null,[e("label",fe,r(t.$t("user_account_settings.tabs.settings.account.phone")),1),y(e("input",{id:"phone","onUpdate:modelValue":s[2]||(s[2]=a=>n.phone=a),type:"text",placeholder:t.$t("user_account_settings.tabs.settings.account.phone"),class:"form-input"},null,8,_e),[[k,n.phone]]),o.value.phone?(u(),d("div",be,r(o.value.phone[0]),1)):c("",!0)]),e("div",null,[e("label",ve,r(t.$t("user_account_settings.tabs.settings.account.email")),1),y(e("input",{id:"email","onUpdate:modelValue":s[3]||(s[3]=a=>n.email=a),type:"email",placeholder:t.$t("user_account_settings.tabs.settings.account.email"),class:"form-input",required:""},null,8,he),[[k,n.email]]),o.value.email?(u(),d("div",we,r(o.value.email[0]),1)):c("",!0)]),e("div",null,[e("label",ye,r(t.$t("user_account_settings.tabs.settings.account.password")),1),y(e("input",{id:"password","onUpdate:modelValue":s[4]||(s[4]=a=>n.password=a),type:"password",placeholder:t.$t("user_account_settings.tabs.settings.account.password"),class:"form-input"},null,8,ke),[[k,n.password]]),o.value.password?(u(),d("div",xe,r(o.value.password[0]),1)):c("",!0)]),e("div",$e,[e("button",{type:"submit",disabled:U.value,class:"btn btn-primary"},[U.value?(u(),d("span",Ue)):c("",!0),$(" "+r(t.$t("user_account_settings.tabs.settings.account.btn_save")),1)],8,Ce)])])])],32),e("form",{onSubmit:B(R,["prevent"]),class:"border border-[#ebedf2] dark:border-[#191e3a] rounded-md p-4 bg-white dark:bg-[#0e1726]"},[e("h6",Ie,r(t.$t("user_account_settings.tabs.settings.only.title")),1),e("div",Ve,[e("div",Ne,[e("div",null,[e("label",je,r(t.$t("user_account_settings.tabs.settings.only.user_name")),1),y(e("input",{id:"user_name","onUpdate:modelValue":s[5]||(s[5]=a=>g.user_name=a),type:"text",placeholder:t.$t("user_account_settings.tabs.settings.only.user_name"),class:"form-input"},null,8,Me),[[k,g.user_name]]),o.value.user_name?(u(),d("div",Se,r(o.value.user_name[0]),1)):c("",!0)]),e("div",null,[e("label",Be,r(t.$t("user_account_settings.tabs.settings.only.password")),1),y(e("input",{id:"user_only_password","onUpdate:modelValue":s[6]||(s[6]=a=>g.password=a),type:"password",placeholder:t.$t("user_account_settings.tabs.settings.only.password"),class:"form-input"},null,8,De),[[k,g.password]]),o.value.user_only_password?(u(),d("div",ze,r(o.value.user_only_password[0]),1)):c("",!0)]),e("div",Ee,[e("button",{type:"submit",disabled:I.value,class:"btn btn-primary"},[I.value?(u(),d("span",Pe)):c("",!0),$(" "+r(t.$t("user_account_settings.tabs.settings.only.btn_save")),1)],8,Le)])])])],32)])]),_:1}),w(v(z),null,{default:b(()=>[e("div",Re,[e("div",Ae,[e("div",Oe,[e("h5",Te,r(t.$t("user_account_settings.tabs.preferences.choose_theme")),1),s[10]||(s[10]=e("div",{class:"flex justify-around"},[e("label",{class:"inline-flex cursor-pointer"},[e("input",{class:"form-radio ltr:mr-4 rtl:ml-4 cursor-pointer",type:"radio",name:"flexRadioDefault",checked:""}),e("span",null,[e("img",{class:"ms-3",width:"100",height:"68",alt:"settings-dark",src:"/assets/images/settings-light.svg"})])]),e("label",{class:"inline-flex cursor-pointer"},[e("input",{class:"form-radio ltr:mr-4 rtrl:ml-4 cursor-pointer",type:"radio",name:"flexRadioDefault"}),e("span",null,[e("img",{class:"ms-3",width:"100",height:"68",alt:"settings-light",src:"/assets/images/settings-dark.svg"})])])],-1))])]),e("div",We,[e("div",qe,[e("h5",Fe,r(t.$t("user_account_settings.tabs.preferences.hide_left_navigation")),1),$(" "+r(t.$t("user_account_settings.tabs.preferences.sidebar_will_be_hidden_by_default"))+" ",1),s[11]||(s[11]=e("label",{class:"w-12 h-6 relative"},[e("input",{type:"checkbox",class:"custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer",id:"custom_switch_checkbox4"}),e("span",{for:"custom_switch_checkbox4",class:"bg-[#ebedf2] dark:bg-dark block h-full rounded-full before:absolute before:left-1 before:bg-white dark:before:bg-white-dark dark:peer-checked:before:bg-white before:bottom-1 before:w-4 before:h-4 before:rounded-full peer-checked:before:left-7 peer-checked:bg-primary before:transition-all before:duration-300"})],-1))])])])]),_:1})]),_:1})]),_:1}))])]))}}),ts=Z(Ge,[["__scopeId","data-v-32df900f"]]);export{ts as default};
